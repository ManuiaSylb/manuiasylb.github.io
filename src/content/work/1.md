---
title: Ensuring Fairness in Pose Estimation Models for Diverse Populations
publishDate: 2025-09-12
order : 1
img: /assets/HPE_example.jpg
img_alt: Example of HPE output, skeleton of keypoints predicted by MMPose HRNET-48
description: |
  We designed an end-to-end pipeline to assess the balance of Human Pose Estimation (HPE) datasets.
tags:
  - Computer Vision
  - Deep Learning
  - Diffusion
---

## Fairness in HPE 

> Despite remarkable progress, human pose estimation remains a challenging task.

Despite remarkable progress driven by deep learning, human pose estimation remains a challenging task. The diversity of human appearances, clothing, and body shapes introduces significant variability. In addition, the human body exhibits complex articulations, making it difficult to accurately capture fine-grained joint dependencies. These challenges are amplified when datasets are imbalanced or lack representative coverage of poses, leading to biased models. 

Our work addresses these issues by designing an end-to-end pipeline that not only evaluates dataset balance but also performs data augmentation through image generation, thereby improving the diversity and representativeness of human pose estimation datasets.

### COCO Dataset

The **COCO (Common Objects in Context)** dataset is one of the most widely used benchmarks in computer vision, covering tasks such as object detection, segmentation, captioning, and crucially **keypoint detection** for human pose estimation. [COCO official website](https://cocodataset.org/?utm_source=chatgpt.com)  

In the COCO keypoints format, each annotated person is described by **17 body keypoints** (e.g., nose, eyes, shoulders, elbows, wrists, hips, knees, ankles), each specified by an (x, y) coordinate and a visibility flag. [COCO keypoints guide](https://www.v7labs.com/blog/coco-dataset-guide?utm_source=chatgpt.com)  

This format allows models to learn to localize human joints in varied scenes. To evaluate pose estimators, COCO uses a metric called **Object Keypoint Similarity (OKS)**, which compares predicted vs. ground-truth keypoints while accounting for object scale and visibility. [OKS explanation](https://learnopencv.com/object-keypoint-similarity/?utm_source=chatgpt.com)  

Because of its scale, annotation quality, and standard evaluation protocols, COCO has become a de facto reference for human pose estimation research.

#### Exploratory Data Analysis

Evaluating the quality and representativeness of human pose estimation datasets is a crucial step toward building reliable models. In our work, we focus on several human-centered and visual attributes that can significantly impact performance: age, gender, body shape, and clothing-to-background contrast. These factors introduce strong variability in appearance and, if imbalanced, can bias the learning process. To systematically assess them, we leverage machine learning models trained to classify these attributes directly from the dataset images. By analyzing the resulting class distributions, we are able to detect overrepresented and underrepresented categories, highlight potential dataset biases, and provide a quantitative basis for further balancing strategies.

![MMPose HRNET-48 performaces on COCO Solo and COCO Solo augmented](/assets/COCOsample_distribution.jpg)

#### Dataset balancing

##### Compensation Algorithm (ILP)

To control the rebalancing process and avoid unnecessary overgeneration, we designed an Integer Linear Programming (ILP)–based compensation algorithm. The goal is not to equalize all categories strictly, but rather to minimize the total number of images to generate while achieving a more balanced diversity across the dataset. The ILP formulation selects which attribute combinations should be augmented so that the overall distribution of human-centered factors (age, gender, or body shape) becomes more uniform, under constraints that preserve annotation variety and dataset coherence. This optimization ensures that generation efforts are focused where they are most needed, leading to a fairer and more representative dataset with minimal synthetic additions.

![MMPose HRNET-48 performaces on COCO Solo and COCO Solo augmented](/assets/COCOsample_aug_distribution.jpg)

The 0–9 years age class was deliberately excluded from the augmentation process. The morphological differences with adult body structures make direct image-to-image translation unsuitable.

##### Image Generation via Pix2Pix

After computing the optimal class proportions, we employ instruc_pix2pix, a conditional image-to-image generative model, to synthesize additional training samples for underrepresented classes. The model takes the original images as input, and we carefully manipulate prompts and model parameters to guide realistic transformations, ensuring diverse appearances, clothing styles, and backgrounds. This approach allows us to generate new images while keeping them consistent with the original scenes, making it possible to reuse the COCO-style annotations from the source images. By combining ILP-guided selection of target classes with instruc_pix2pix–based transformations, we build a controlled, data-driven augmentation pipeline that enriches dataset diversity and improves fairness in human pose estimation models.

![MMPose HRNET-48 performaces on COCO Solo and COCO Solo augmented](/assets/pix2pix.jpg)

#### Results

Evaluation of the **HRNET-48** models on sample datasets **COCO Solo** and **COCO Solo Augmented** shows a clear performance gain when data augmentation is applied.

- **Mean Average Precision (AP):**  
  - Base Model: **0.655**  
  - Augmented Model: **0.691**  

This corresponds to an average improvement of **5 percentage points**.

- **Fairness of Performance:**  
  The **standard deviation** slightly decreases with the augmented model (0.092 vs 0.096), indicating **more consistent performance** across different combinations, making the model **more robust** and **less sensitive** to appearance variations.

In summary, data augmentation not only improves the average performance (+5%) but also **reduces performance variance**, resulting in a **more reliable model** across diverse scenarios.

![MMPose HRNET-48 performaces on COCO Solo and COCO Solo augmented](/assets/HPE_comparaison.png)


